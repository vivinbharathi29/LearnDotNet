
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1"><title>
	File Upload
</title><link href="../style/general.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
		.ProgressBar {
			margin: 0px;
			border: 0px;
			padding: 0px;
			width: 100%;
			height: 3em;
		}
		</style>

    <script type="text/javascript">
    <!--
    function body_onLoad(){
        if (form1.hidReturnValue.value != "") {
            window.returnValue = form1.hidReturnValue.value;
            window.parent.close();
            }
        }
    
    function cancelButton_onClick() {
        window.parent.close();
    }
    //-->
    </script>

</head>
<body onload="body_onLoad()" style="background-color: #FFFFF0;">
    <form name="form1" method="post" action="fileupload.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="form1" enctype="multipart/form-data">
<div>
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTA0NzEzNDA1NQ9kFgICAw8WBB4HZW5jdHlwZQUTbXVsdGlwYXJ0L2Zvcm0tZGF0YR4GbWV0aG9kBQRwb3N0FggCAQ8PFgIeBFRleHQFFUV4Y2FsaWJ1ciBGaWxlIFVwbG9hZGRkAgcPDxYEHhRWYWxpZGF0aW9uRXhwcmVzc2lvbgUgXig/IS4qXC4oZXhlfGJhdHxtc2l8anN8Y21kKSQpLioeDEVycm9yTWVzc2FnZQUhRXhlY3V0YWJsZSBGaWxlcyBBcmUgTm90IEFsbG93ZWQuZGQCCQ8PZBYKHgVjbGFzcwULUHJvZ3Jlc3NCYXIeA3NyYwVlL05lYXRVcGxvYWQvUHJvZ3Jlc3MuYXNweD9wb3N0QmFja0lEPTFCNTU3MUYzQzFGRTAwNTRFMkI4QkRGMzIyRTc1NzcyJmNhblNjcmlwdD1mYWxzZSZjYW5DYW5jZWw9ZmFsc2UeC2ZyYW1lYm9yZGVyBQEwHglzY3JvbGxpbmcFAm5vHgRuYW1lBQxQcm9ncmVzc0JhcjFkAgsPDxYCHg1PbkNsaWVudENsaWNrBWR0aGlzLnZhbHVlPSdVcGxvYWRpbmcuLi4nO3NldFRpbWVvdXQoJ2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwnc3VibWl0QnV0dG9uXCcpLmRpc2FibGVkPXRydWUnLDEwMCk7ZGRkjVht1lZcBfE5GQABW0UXGzEI+Qo=" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<script src="./WebResource.axd?d=MdjyqYmujEB9mzUPoOuWBRSs8odDxI2u2N0PfCYdaJr7ShhuJbgHFHBXt4IWRCwG0oTPZ_svi0jlURMc-ouW6SP_3Yw1&amp;t=634210184612724343" type="text/javascript"></script>


<script src="./WebResource.axd?d=hRJ3I0IB2tVLbNP9o_nxMbP01PmqhbM8pLZM1lbFP-qUs6fQtB570W_6dFi56cSvuconhYkkrXfKSUxQ3QETo3X_41A1&amp;t=634210184612724343" type="text/javascript"></script>
<script type="text/javascript" language="javascript">
<!--

if (!Array.prototype.push)
{
	Array.prototype.push = function() {
		for (var i = 0; i < arguments.length; i++)
			this[this.length] = arguments[i];
		return this.length;
	};
}

if (!Array.prototype.unshift)
{
	Array.prototype.unshift = function() {
		this.reverse();
		for (var i = 0; i < arguments.length; i++)
			this[this.length] = arguments[i];
		this.reverse();
		return this.length;
	};
}

if (!Function.prototype.call)
{
	Function.prototype.call = function() {
		var obj = arguments[0];
		obj._NeatUpload_tmpFunc = this;
		var argList = '';
		for (var i = 1; i < arguments.length; i++)
		{
			argList += 'arguments[' + i + ']';
			if (i < arguments.length - 1)
				argList += ',';
		}
		var result = eval('obj._NeatUpload_tmpFunc(' + argList + ')');
		obj._NeatUpload_tmpFunc = null;
		return result;
	};
}

function NeatUpload_IsElemWithin(elem, assocArray)
{
	while (elem)
	{
		if (elem.id && assocArray[elem.id])
		{
			return true;
		}
		elem = elem.parentNode;
	}
}

function NeatUploadCanCancel()
{
	try
	{
		if (window.stop || window.document.execCommand)
			return true;
		else
			return false;
	}
	catch (ex)
	{
		return false;
	}
}
function NeatUpload_CombineHandlers(origHandler, newHandler) 
{
	if (!origHandler || typeof(origHandler) == 'undefined') return newHandler;
	return function(e) { if (origHandler(e) == false) return false; return newHandler(e); };
};
function NeatUpload_AddHandler(id, eventName, handler, useCapture)
{
	if (typeof(useCapture) == 'undefined')
		useCapture = false;
	if (!document.getElementById)
		return;
	var elem = document.getElementById(id);
	if (elem.addEventListener)
	{
		elem.addEventListener(eventName, handler, useCapture);
	}
	else if (elem.attachEvent)
	{
		elem.attachEvent("on" + eventName, handler);
	}
	else
	{
		elem["on" + eventName] = NeatUpload_CombineHandlers(elem["on" + eventName], handler);
	}
}
function NeatUpload_IsFilesToUpload(id)
{
	if (!document.getElementById)
		return false;
	var formElem = document.getElementById(id);
	while (formElem && formElem.tagName.toLowerCase() != "form")
	{
		formElem = formElem.parent;
	}
	if (!formElem) 
	{
		return false;
	}
	var inputElems = formElem.getElementsByTagName("input");
	var foundFileInput = false;
	var isFilesToUpload = false;
	for (i = 0; i < inputElems.length; i++)
	{
		var inputElem = inputElems.item(i);
		if (inputElem && inputElem.type && inputElem.type.toLowerCase() == "file")
		{
			foundFileInput = true;
			if (inputElem.value && inputElem.value.length > 0)
			{
				isFilesToUpload = true;

				// If the browser really is IE on Windows, return false if the path is not absolute because
				// IE will not actually submit the form if any file value is not an absolute path.  If IE doesn't
				// submit the form, any progress bars we start will never finish.  
				if (navigator && navigator.userAgent)
				{
					var ua = navigator.userAgent.toLowerCase();
					var msiePosition = ua.indexOf('msie');
					if (msiePosition != -1 && typeof(ActiveXObject) != 'undefined' && ua.indexOf('mac') == -1
					    && ua.charAt(msiePosition + 5) < 8)
					{
						var re = new RegExp('^(\\\\\\\\[^\\\\]|([a-zA-Z]:)?\\\\).*');
						var match = re.exec(inputElem.value);
						if (match == null || match[0] == '')
						{
							if (typeof(NeatUpload_HandleIE6InvalidPath) != 'undefined'
							    && NeatUpload_HandleIE6InvalidPath != null)
								NeatUpload_HandleIE6InvalidPath(inputElem);
							return false;
						}
					}
				}
			}
		}
	}
	return isFilesToUpload; 
}

function NeatUpload_ClearFileInputs(elem)
{
	var inputFiles = elem.getElementsByTagName('input');
	for (var i=0; i < inputFiles.length; i++ )
	{
		var inputFile = inputFiles.item(i);
		// NOTE: clearing (by removing and recreating) empty file inputs confuses IE6 when the document is
		// in both the top-level window and in an iframe.  ExpertTree uses such an iframe to do AJAX-style
		// callbacks.
		if (inputFile.type == 'file' && inputFile.value && inputFile.value.length > 0)
		{
			try
			{
				var newInputFile = document.createElement('input');
				for (var a=0; a < inputFile.attributes.length; a++)
				{
					var attr = inputFile.attributes.item(a); 
					if (! attr.specified)
						continue;
					var attrName = attr.name.toLowerCase();
					if (attrName != 'type' && attrName != 'value')
					{
						if (attrName == 'style' && newInputFile.style && newInputFile.style.cssText)
							newInputFile.style.cssText = attr.value;
						else if (attrName == 'class') // Needed for IE because 'class' is a JS keyword
							newInputFile.className = attr.value;
						else if (attrName == 'for') // Needed for IE because 'for' is a JS keyword
							newInputFile.htmlFor = attr.value;
						else
							newInputFile.setAttribute(attr.name, attr.value);
					}
				}
				newInputFile.setAttribute('type', 'file');
				inputFile.parentNode.replaceChild(newInputFile, inputFile);
			}
			catch (ex)
			{
				// I don't know of any other way to clear the file inputs, so on browser where we get an error
				// (eg Mac IE), we just give the user a warning.
				if (inputFile.value != null && inputFile.value != '')
				{
					if (!NeatUpload_AlertShown)
					{
						window.alert('Please clear the file names and try again.');
						NeatUpload_AlertShown = true;
					}
					return false;
				}
			}
		}
	}
	return true;
}

function NeatUpload_AddSubmitHandler(formID, isPopup, handler)
{
	if (!document.getElementById)
		return;
	var elem = document.getElementById(formID);
	if (!elem.NeatUpload_OnSubmitHandlers) 
	{
		elem.NeatUpload_OnSubmitHandlers = new Array();
		elem.NeatUpload_OrigSubmit = elem.submit;
		elem.NeatUpload_OnSubmit = NeatUpload_OnSubmit;
		try
		{
			elem.submit = function () {
				elem.NeatUpload_OnSubmitting();
				elem.NeatUpload_OrigSubmit();
				elem.NeatUpload_OnSubmit();
			};
		}
		catch (ex)
		{
			// We can't override the submit method.  That means NeatUpload won't work 
			// when the form is submitted programmatically.  This occurs in Mac IE.
		}			
	}
	if (isPopup)
	{
		elem.NeatUpload_OnSubmitHandlers.unshift(handler);
	}
	else
	{
		elem.NeatUpload_OnSubmitHandlers.push(handler);
	}	
}

function NeatUpload_AddSubmittingHandler(formID, handler)
{
	if (!document.getElementById)
		return;
	var elem = document.getElementById(formID);
	if (!elem.NeatUpload_OnSubmittingHandlers) 
	{
		elem.NeatUpload_OnSubmittingHandlers = new Array();
		elem.NeatUpload_OnSubmitting = NeatUpload_OnSubmitting;
	}
	elem.NeatUpload_OnSubmittingHandlers.push(handler);
}

function NeatUpload_OnSubmitting()
{
	for (var i=0; i < this.NeatUpload_OnSubmittingHandlers.length; i++)
	{
		this.NeatUpload_OnSubmittingHandlers[i].call(this);
	}
	return true;
}

function NeatUpload_OnSubmit()
{
	for (var i=0; i < this.NeatUpload_OnSubmitHandlers.length; i++)
	{
		if (!this.NeatUpload_OnSubmitHandlers[i].call(this))
			return false;
	}
	return true;
}
// -->
</script>

<script type="text/javascript">
//<![CDATA[
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;NeatUpload_OnSubmitForm_form1();
return true;
}
//]]>
</script>

        <h3>
            <span id="lblTitle">Excalibur File Upload</span>
        </h3>
            
            
        <p><span id="instructions" class="Note">Maximum Upload Size is 500MB</span>
            <input type="hidden" name="NeatUploadConfig_InputFile1" value="FAJ/u3en1zlx4aZPhpM2TUjAspbBEAIwC7UUii3MTo7t0+pXYr3clKGc7+pXCpObfOEakC7pG/WO0cFVmM5akWykyNRhyTJQGLjfZIAHiTPf8nsV3WvYpnU9TfBYV8ZwxSZB15XP" /><input type="file" name="NeatUpload_1B5571F3C1FE0054E2B8BDF322E75772-InputFile1" id="InputFile1" style="display:inline-block;width:95%;" /><br />
            <span id="RegularExpressionValidator1" style="color:Red;visibility:hidden;">Executable Files Are Not Allowed.</span>
            <iframe id="ProgressBar1" class="ProgressBar" src="../NeatUpload/Progress.aspx?postBackID=1B5571F3C1FE0054E2B8BDF322E75772&amp;canScript=false&amp;canCancel=false" frameborder="0" scrolling="no" name="ProgressBar1" style="display:inline-block;width:95%;">

</iframe>
            </p>
        <p>
            <input type="submit" name="submitButton" value="Submit" onclick="this.value='Uploading...';setTimeout('document.getElementById(\'submitButton\').disabled=true',100);WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;submitButton&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, false))" id="submitButton" />
            <input id="cancelButton" type="button" value="Cancel" onclick="cancelButton_onClick()" />
            <input type="hidden" name="hidReturnValue" id="hidReturnValue" />
        </p>
    
<script type="text/javascript">
//<![CDATA[
var Page_Validators =  new Array(document.getElementById("RegularExpressionValidator1"));
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
var RegularExpressionValidator1 = document.all ? document.all["RegularExpressionValidator1"] : document.getElementById("RegularExpressionValidator1");
RegularExpressionValidator1.controltovalidate = "InputFile1";
RegularExpressionValidator1.errormessage = "Executable Files Are Not Allowed.";
RegularExpressionValidator1.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
RegularExpressionValidator1.validationexpression = "^(?!.*\\.(exe|bat|msi|js|cmd)$).*";
//]]>
</script>

<div>

	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWAwKEgKncCgKSuuDUCwKMk8C5Bp43y84+QXr0zrtJ79MsHrFnO9iA" />
</div>

<script type="text/javascript">
//<![CDATA[

var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
        //]]>
</script>

<script type="text/javascript" language="javascript">
<!--
if (frames['ProgressBar1'])
	frames['ProgressBar1'].location.replace('/NeatUpload/Progress.aspx?postBackID=1B5571F3C1FE0054E2B8BDF322E75772&canScript=true&canCancel=' + NeatUploadCanCancel());
// -->
</script>

<script type="text/javascript" language="javascript">
<!--
function NeatUpload_OnSubmitForm_form1()
{
	var elem = document.getElementById('form1');
	return elem.NeatUpload_OnSubmit();
}
// -->
</script>

<script type="text/javascript" language="javascript">
<!--

NeatUpload_FallbackLink = document.getElementById ? document.getElementById('ProgressBar1_fallback_link') : null;
if (NeatUpload_FallbackLink)
	NeatUpload_FallbackLink.setAttribute('href', "javascript:window.open('/NeatUpload/Progress.aspx?postBackID=1B5571F3C1FE0054E2B8BDF322E75772&refresher=client&canScript=true&canCancel=' + NeatUploadCanCancel(), '1B5571F3C1FE0054E2B8BDF322E75772','width=500,height=100,directories=no,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,toolbar=no');");
						
if (typeof(NeatUpload_NonUploadIDs) == 'undefined')
{
	NeatUpload_NonUploadIDs = new Object();
	NeatUpload_NonUploadIDs.NeatUpload_length = 0;
}
if (typeof(NeatUpload_TriggerIDs) == 'undefined')
{
	NeatUpload_TriggerIDs = new Object();
	NeatUpload_TriggerIDs.NeatUpload_length = 0;
}
NeatUpload_NonUploadIDs_ProgressBar1 = new Object();
NeatUpload_NonUploadIDs_ProgressBar1.NeatUpload_length = 0;
NeatUpload_TriggerIDs_ProgressBar1 = new Object();
NeatUpload_TriggerIDs_ProgressBar1.NeatUpload_length = 0;

NeatUpload_LastEventSource = null;
NeatUpload_LastEventType = null;
NeatUpload_AlertShown = true;

NeatUpload_AddSubmitHandler('form1',false, function () {
	var formElem = document.getElementById('form1');
	// If trigger controls were specified for this progress bar and the trigger is not 
	// specified for *any* progress bar, then clear the filenames.
	if (NeatUpload_LastEventSource
	    && (NeatUpload_IsElemWithin(NeatUpload_LastEventSource, NeatUpload_NonUploadIDs_ProgressBar1)
	      	|| NeatUpload_TriggerIDs_ProgressBar1.NeatUpload_length)
	    && !NeatUpload_IsElemWithin(NeatUpload_LastEventSource, NeatUpload_TriggerIDs))
	{
		return NeatUpload_ClearFileInputs(formElem);
	}
	// If there are files to upload and either no trigger controls were specified for this progress bar or
	// a specified trigger control was triggered, then start the progress display.
	if (NeatUpload_IsFilesToUpload('form1')
		&& (!NeatUpload_TriggerIDs_ProgressBar1.NeatUpload_length
		    || NeatUpload_IsElemWithin(NeatUpload_LastEventSource, NeatUpload_TriggerIDs_ProgressBar1)))
	{
		
setTimeout("frames['ProgressBar1'].location.href = '/NeatUpload/Progress.aspx?postBackID=1B5571F3C1FE0054E2B8BDF322E75772&refresher=client&canScript=true&canCancel=' + NeatUploadCanCancel();", 0);

	}
	return true;
});
						
NeatUpload_EventsThatCouldTriggerPostBack = ['click', 'keypress', 'change', 'drop', 'mousedown', 'keydown'];
						
for (var i = 0; i < NeatUpload_EventsThatCouldTriggerPostBack.length; i++)
{
	var eventName = NeatUpload_EventsThatCouldTriggerPostBack[i];
	NeatUpload_AddHandler('form1', eventName, function (ev) {
		ev = ev || window.event;
		if (!ev)
		{
			return true;
		}
		var src = ev.srcElement || ev.target;
		if (!src)
		{
			return true;
		}
		NeatUpload_LastEventType = ev.type;
		NeatUpload_LastEventSource = src;
		NeatUpload_AlertShown = false;
		if (ev.type != 'click' && ev.type != 'keypress')
		{
			return true;
		}
		if (NeatUpload_IsElemWithin(src, NeatUpload_TriggerIDs)
		      || NeatUpload_TriggerIDs.NeatUpload_length == 0)
		{
			return true;
		}
		var tagName = src.tagName;
		if (!tagName)
		{
			return true;
		}
		tagName = tagName.toLowerCase();
		if (tagName == 'input' || tagName == 'button')
		{
			var inputType = src.getAttribute('type');
			if (inputType) inputType = inputType.toLowerCase();
			if (document.getElementById && (!inputType || inputType == 'submit' || inputType == 'image'))
			{
				var formElem = document.getElementById('form1');
				NeatUpload_ClearFileInputs(formElem);
			}
		}
		return true;
	}, true);
}

NeatUpload_AddSubmittingHandler('form1', function () {
	if (!NeatUpload_LastEventSource)
	{
		return;
	}
	if (NeatUpload_IsElemWithin(NeatUpload_LastEventSource, NeatUpload_TriggerIDs))
	{
		return;
	}
	var formElem = document.getElementById('form1');
	if (NeatUpload_IsElemWithin(NeatUpload_LastEventSource, NeatUpload_NonUploadIDs)
	     || NeatUpload_TriggerIDs.NeatUpload_length)
	{
		NeatUpload_ClearFileInputs(formElem);
	}
});

NeatUpload_TriggerIDs['submitButton'] 
	= ++NeatUpload_TriggerIDs.NeatUpload_length;
NeatUpload_TriggerIDs_ProgressBar1['submitButton'] 
	= ++NeatUpload_TriggerIDs_ProgressBar1.NeatUpload_length;

// -->
</script>
</form>
</body>
</html>
